<?xml version="1.0" encoding="UTF-8"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>Ann Moon&#39;s Blog</title>
    <description>Ann Moon&#39;s Blogs</description>
    <link>/</link>
    <atom:link href="/feed.xml" rel="self" type="application/rss+xml"/>
    <pubDate>Thu, 02 Jun 2016 15:27:40 +0900</pubDate>
    <lastBuildDate>Thu, 02 Jun 2016 15:27:40 +0900</lastBuildDate>
    <generator>Jekyll v3.0.3</generator>
    
      <item>
        <title>How to Install and Configure MySQL Cluster on CentOS 7</title>
        <description>&lt;h3 id=&quot;cluster-nodes&quot;&gt;Cluster nodes&lt;/h3&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;Role&lt;/th&gt;
      &lt;th&gt;Hostname&lt;/th&gt;
      &lt;th&gt;OS&lt;/th&gt;
      &lt;th&gt;IP&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td&gt;Management Node&lt;/td&gt;
      &lt;td&gt;ndb_mgmd&lt;/td&gt;
      &lt;td&gt;CentOS 7&lt;/td&gt;
      &lt;td&gt;192.168.1.57&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;Data Node 1&lt;/td&gt;
      &lt;td&gt;ndb01&lt;/td&gt;
      &lt;td&gt;CentOS 7&lt;/td&gt;
      &lt;td&gt;192.168.1.12&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;Data Node 2&lt;/td&gt;
      &lt;td&gt;ndb02&lt;/td&gt;
      &lt;td&gt;CentOS 7&lt;/td&gt;
      &lt;td&gt;192.168.1.50&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;API Node 1&lt;/td&gt;
      &lt;td&gt;api01&lt;/td&gt;
      &lt;td&gt;CentOS 7&lt;/td&gt;
      &lt;td&gt;192.168.1.51&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;API Node 2&lt;/td&gt;
      &lt;td&gt;api02&lt;/td&gt;
      &lt;td&gt;CentOS 7&lt;/td&gt;
      &lt;td&gt;192.168.1.62&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;h3 id=&quot;setup-management-node&quot;&gt;Setup Management Node&lt;/h3&gt;

&lt;h4 id=&quot;download--install--remove-packages&quot;&gt;1) Download / install / remove packages&lt;/h4&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;root@ndb_mgmd ~]# &lt;span class=&quot;nb&quot;&gt;cd&lt;/span&gt; /var/tmp
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;root@ndb_mgmd tmp]# 
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;root@ndb_mgmd tmp]# 
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;root@ndb_mgmd tmp]# wget http://dev.mysql.com/get/Downloads/MySQL-Cluster-7.4/MySQL-Cluster-gpl-7.4.10-1.el7.x86_64.rpm-bundle.tar
--2016-06-01 08:55:44--  http://dev.mysql.com/get/Downloads/MySQL-Cluster-7.4/MySQL-Cluster-gpl-7.4.10-1.el7.x86_64.rpm-bundle.tar
Resolving dev.mysql.com &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;dev.mysql.com&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;... 137.254.60.11
Connecting to dev.mysql.com &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;dev.mysql.com&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;|137.254.60.11|:80... connected.
HTTP request sent, awaiting response... 302 Found
Location: http://cdn.mysql.com//Downloads/MySQL-Cluster-7.4/MySQL-Cluster-gpl-7.4.10-1.el7.x86_64.rpm-bundle.tar &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;following]
--2016-06-01 08:55:44--  http://cdn.mysql.com//Downloads/MySQL-Cluster-7.4/MySQL-Cluster-gpl-7.4.10-1.el7.x86_64.rpm-bundle.tar
Resolving cdn.mysql.com &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;cdn.mysql.com&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;... 104.76.138.251
Connecting to cdn.mysql.com &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;cdn.mysql.com&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;|104.76.138.251|:80... connected.
HTTP request sent, awaiting response... 200 OK
Length: 384563200 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;367M&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;application/x-tar]
Saving to: ‘MySQL-Cluster-gpl-7.4.10-1.el7.x86_64.rpm-bundle.tar’

&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;root@ndb_mgmd tmp]# tar xvf MySQL-Cluster-gpl-7.4.10-1.el7.x86_64.rpm-bundle.tar
MySQL-Cluster-client-gpl-7.4.10-1.el7.x86_64.rpm
MySQL-Cluster-test-gpl-7.4.10-1.el7.x86_64.rpm
MySQL-Cluster-devel-gpl-7.4.10-1.el7.x86_64.rpm
MySQL-Cluster-embedded-gpl-7.4.10-1.el7.x86_64.rpm
MySQL-Cluster-server-gpl-7.4.10-1.el7.x86_64.rpm
MySQL-Cluster-shared-compat-gpl-7.4.10-1.el7.x86_64.rpm
MySQL-Cluster-shared-gpl-7.4.10-1.el7.x86_64.rpm&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;ul&gt;
  &lt;li&gt;if you did not install perl-Data-Dumper yet, you should install first and remove mariadb-libs package.&lt;/li&gt;
&lt;/ul&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;root@ndb_mgmd tmp]# yum -y install perl-Data-Dumper
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;root@ndb_mgmd tmp]# yum -y remove mariadb-libs
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;root@ndb_mgmd tmp]# rpm -Uvh MySQL-Cluster-client-gpl-7.4.10-1.el7.x86_64.rpm
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;root@ndb_mgmd tmp]# rpm -Uvh MySQL-Cluster-server-gpl-7.4.10-1.el7.x86_64.rpm
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;root@ndb_mgmd tmp]# rpm -Uvh MySQL-Cluster-shared-gpl-7.4.10-1.el7.x86_64.rpm&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;h4 id=&quot;configure-mysql-cluster&quot;&gt;2) Configure MySQL Cluster&lt;/h4&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;root@ndb_mgmd tmp]# mkdir -p /var/lib/mysql-cluster
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;root@ndb_mgmd tmp]# &lt;span class=&quot;nb&quot;&gt;cd&lt;/span&gt; /var/lib/mysql-cluster
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;root@ndb_mgmd mysql-cluster]# vi config.ini&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;ul&gt;
  &lt;li&gt;Paste the below configuration on config.ini&lt;/li&gt;
&lt;/ul&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;ndb_mgmd default]
&lt;span class=&quot;c&quot;&gt;# Directory for MGM node log files&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;DataDir&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;/var/lib/mysql-cluster

&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;ndb_mgmd]
&lt;span class=&quot;c&quot;&gt;#Management Node&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;HostName&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;192.168.1.57

&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;ndbd default]
&lt;span class=&quot;nv&quot;&gt;NoOfReplicas&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;2      &lt;span class=&quot;c&quot;&gt;# Number of replicas&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;DataMemory&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;256M     &lt;span class=&quot;c&quot;&gt;# Memory allocate for data storage&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;IndexMemory&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;128M    &lt;span class=&quot;c&quot;&gt;# Memory allocate for index storage&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;#Directory for Data Node&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;DataDir&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;/var/lib/mysql-cluster

&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;ndbd]
&lt;span class=&quot;c&quot;&gt;#Data Node 1&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;HostName&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;192.168.1.12

&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;ndbd]
&lt;span class=&quot;c&quot;&gt;#Data Node 2&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;HostName&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;192.168.1.50

&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;mysqld]
&lt;span class=&quot;c&quot;&gt;#SQL(api) Node 1&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;HostName&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;192.168.1.51

&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;mysqld]
&lt;span class=&quot;c&quot;&gt;#SQL(api) Node 2&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;HostName&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;192.168.1.62&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;h4 id=&quot;start-the-management-node&quot;&gt;3) Start the Management Node&lt;/h4&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;root@ndb_mgmd mysql-cluster]# ndb_mgmd --config-file&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;/var/lib/mysql-cluster/config.ini
MySQL Cluster Management Server mysql-5.6.28 ndb-7.4.10
2016-06-01 09:18:25 &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;MgmtSrvr] INFO     -- The default config directory &lt;span class=&quot;s1&quot;&gt;&#39;/usr/mysql-cluster&#39;&lt;/span&gt; does not exist. Trying to create it...
2016-06-01 09:18:25 &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;MgmtSrvr] INFO     -- Sucessfully created config directory&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;h4 id=&quot;monitor-the-node&quot;&gt;4) monitor the node&lt;/h4&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;root@ndb_mgmd mysql-cluster]# ndb_mgm
-- NDB Cluster -- Management Client --
&lt;span class=&quot;gp&quot;&gt;ndb_mgm&amp;gt; &lt;/span&gt;show
Connected to Management Server at: localhost:1186
Cluster Configuration
---------------------
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;ndbd&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;NDB&lt;span class=&quot;o&quot;&gt;)]&lt;/span&gt;     2 node&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;s&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;id&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;2 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;not connected, accepting connect from 192.168.1.12&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;id&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;3 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;not connected, accepting connect from 192.168.1.50&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;ndb_mgmd&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;MGM&lt;span class=&quot;o&quot;&gt;)]&lt;/span&gt; 1 node&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;s&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;id&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;1    @192.168.1.57  &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;mysql-5.6.28 ndb-7.4.10&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;mysqld&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;API&lt;span class=&quot;o&quot;&gt;)]&lt;/span&gt;   2 node&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;s&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;id&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;4 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;not connected, accepting connect from 192.168.1.51&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;id&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;5 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;not connected, accepting connect from 192.168.1.62&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;gp&quot;&gt;ndb_mgm&amp;gt; &lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;h3 id=&quot;setup-the-mysql-cluster-data-nodes&quot;&gt;Setup the MySQL Cluster Data Nodes&lt;/h3&gt;

&lt;h4 id=&quot;download--install--remove-packages-1&quot;&gt;1) Download / install / remove packages&lt;/h4&gt;

&lt;ul&gt;
  &lt;li&gt;login as root user to Data Node 1 (192.168.1.12)&lt;/li&gt;
&lt;/ul&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;root@ndb01 ~]# &lt;span class=&quot;nb&quot;&gt;cd&lt;/span&gt; /var/tmp
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;root@ndb01 tmp]# wget http://dev.mysql.com/get/Downloads/MySQL-Cluster-7.4/MySQL-Cluster-gpl-7.4.10-1.el7.x86_64.rpm-bundle.tar
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;root@ndb01 tmp]# tar xvf MySQL-Cluster-gpl-7.4.10-1.el7.x86_64.rpm-bundle.tar
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;root@ndb01 tmp]# yum -y install perl-Data-Dumper
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;root@ndb01 tmp]# yum -y remove mariadb-libs

&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;root@ndb01 tmp]# rpm -Uvh MySQL-Cluster-client-gpl-7.4.10-1.el7.x86_64.rpm
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;root@ndb01 tmp]# rpm -Uvh MySQL-Cluster-server-gpl-7.4.10-1.el7.x86_64.rpm
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;root@ndb01 tmp]# rpm -Uvh MySQL-Cluster-shared-gpl-7.4.10-1.el7.x86_64.rpm&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;h4 id=&quot;configure-data-node&quot;&gt;2) Configure Data Node&lt;/h4&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;root@ndb01 tmp]# vi /etc/my.cnf&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;ul&gt;
  &lt;li&gt;Paste configuration below:&lt;/li&gt;
&lt;/ul&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;mysqld]
ndbcluster
ndb-connectstring&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;192.168.1.57     &lt;span class=&quot;c&quot;&gt;# IP address of Management Node&lt;/span&gt;

&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;mysql_cluster]
ndb-connectstring&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;192.168.1.57     &lt;span class=&quot;c&quot;&gt;# IP address of Management Node&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;ul&gt;
  &lt;li&gt;Then create the new directory for the database data that we defined in the management node config file “config.ini” and then start data node.&lt;/li&gt;
&lt;/ul&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;root@ndb01 tmp]# mkdir -p /var/lib/mysql-cluster
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;root@ndb01 tmp]# ndbd
2016-06-02 01:38:34 &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;ndbd] INFO     -- Angel connected to &lt;span class=&quot;s1&quot;&gt;&#39;192.168.1.57:1186&#39;&lt;/span&gt;
2016-06-02 01:38:34 &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;ndbd] INFO     -- Angel allocated nodeid: 2&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;ul&gt;
  &lt;li&gt;for Data Node 1 (192.168.1.50), do same things (1,2)&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;h3 id=&quot;setup-sqlapi-node&quot;&gt;Setup SQL(API) Node&lt;/h3&gt;

&lt;h4 id=&quot;download--install--remove-packages-2&quot;&gt;1) Download / install / remove packages&lt;/h4&gt;

&lt;ul&gt;
  &lt;li&gt;login as root user to API node 1 (192.158.1.51)&lt;/li&gt;
&lt;/ul&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;root@api01 ~]# &lt;span class=&quot;nb&quot;&gt;cd&lt;/span&gt; /var/tmp
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;root@api01 tmp]# wget http://dev.mysql.com/get/Downloads/MySQL-Cluster-7.4/MySQL-Cluster-gpl-7.4.10-1.el7.x86_64.rpm-bundle.tar
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;root@api01 tmp]# tar xvf MySQL-Cluster-gpl-7.4.10-1.el7.x86_64.rpm-bundle.tar
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;root@api01 tmp]# yum -y install perl-Data-Dumper
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;root@api01 tmp]# yum -y remove mariadb-libs
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;root@api01 tmp]# rpm -Uvh MySQL-Cluster-client-gpl-7.4.10-1.el7.x86_64.rpm
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;root@api01 tmp]# rpm -Uvh MySQL-Cluster-server-gpl-7.4.10-1.el7.x86_64.rpm
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;root@api01 tmp]# rpm -Uvh MySQL-Cluster-shared-gpl-7.4.10-1.el7.x86_64.rpm&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;h4 id=&quot;configure-the-sql-node&quot;&gt;2) Configure the SQL Node&lt;/h4&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;root@api01 tmp]# vi /etc/my.cnf&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;ul&gt;
  &lt;li&gt;paste configuration below:&lt;/li&gt;
&lt;/ul&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;mysqld]
ndbcluster
ndb-connectstring&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;192.168.1.57       &lt;span class=&quot;c&quot;&gt;# IP address for server management node&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;default_storage_engine&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;ndbcluster     &lt;span class=&quot;c&quot;&gt;# Define default Storage Engine used by MySQL&lt;/span&gt;

&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;mysql_cluster]
ndb-connectstring&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;192.168.1.57       &lt;span class=&quot;c&quot;&gt;# IP address for server management node&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;ul&gt;
  &lt;li&gt;Start SQL node&lt;/li&gt;
&lt;/ul&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;root@api01 tmp]# service mysql start
Starting MySQL................................ SUCCESS!&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;ul&gt;
  &lt;li&gt;Check the status on Management Node. If api node is unable to connect as below, check the mysql err log on api.&lt;/li&gt;
&lt;/ul&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;mysqld&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;API&lt;span class=&quot;o&quot;&gt;)]&lt;/span&gt; 2 node&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;s&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;id&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;4 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;not connected, accepting connect from any host&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;ul&gt;
  &lt;li&gt;if you see below logs on /var/lib/mysql/{hostname}.err, you can try to stop mysql process and then start with below command line.&lt;/li&gt;
&lt;/ul&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;2016-06-02 01:54:47 11362 [Note] NDB: NodeID is 4, management server &#39;192.168.1.57:1186&#39;
2016-06-02 01:55:17 11362 [Note] NDB[0]: NodeID: 4, no storage nodes connected (timed out)
2016-06-02 01:55:17 11362 [Warning] NDB: server id set to zero - changes logged to bin log with server id zero will be logged with another server id by slave mysqlds&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;root@api01 ~]# service mysqld stop
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;root@api01 ~]# /bin/sh /usr/bin/mysqld_safe --datadir&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;/var/lib/mysql --user&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;mysql --ndbcluster --ndb-connectstring&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;192.168.1.57:1186&amp;amp;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;ul&gt;
  &lt;li&gt;For API Node 2 (192.168.1.62), do same things (1,2)&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;h4 id=&quot;check-status-on-management-node&quot;&gt;3) check status on management node&lt;/h4&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;gp&quot;&gt;ndb_mgm&amp;gt; &lt;/span&gt;show
Cluster Configuration
---------------------
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;ndbd&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;NDB&lt;span class=&quot;o&quot;&gt;)]&lt;/span&gt;     2 node&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;s&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;id&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;2    @192.168.1.12  &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;mysql-5.6.28 ndb-7.4.10, Nodegroup: 0, &lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;id&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;3    @192.168.1.50  &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;mysql-5.6.28 ndb-7.4.10, Nodegroup: 0&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;ndb_mgmd&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;MGM&lt;span class=&quot;o&quot;&gt;)]&lt;/span&gt; 1 node&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;s&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;id&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;1    @192.168.1.57  &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;mysql-5.6.28 ndb-7.4.10&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;mysqld&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;API&lt;span class=&quot;o&quot;&gt;)]&lt;/span&gt;   2 node&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;s&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;id&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;4    @192.168.1.51  &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;mysql-5.6.28 ndb-7.4.10&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;id&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;5    @192.168.1.62  &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;mysql-5.6.28 ndb-7.4.10&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;h3 id=&quot;testing-the-cluster&quot;&gt;Testing the Cluster&lt;/h3&gt;

&lt;ul&gt;
  &lt;li&gt;for security, it is better to change random root password on SQL (API) nodes.&lt;/li&gt;
&lt;/ul&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;root@api01 ~]# cat /root/.mysql_secret
&lt;span class=&quot;c&quot;&gt;# The random password set for the root user at Thu Jun  2 01:53:40 2016 (local time): xxxxxxxxxxx&lt;/span&gt;

&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;root@api01 ~]# mysql_secure_installation&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;ul&gt;
  &lt;li&gt;After chaning root password, login to mysql and then create a nw user with host “@”, so we will be able to access the MySQL from outside.&lt;/li&gt;
&lt;/ul&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;root@api01 ~]# mysql -u root -p
Enter password: &lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-sql&quot; data-lang=&quot;sql&quot;&gt;&lt;span class=&quot;n&quot;&gt;Welcome&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;to&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;the&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;MySQL&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;monitor&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;  &lt;span class=&quot;n&quot;&gt;Commands&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;end&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;with&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;or&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;\&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;g&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;Your&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;MySQL&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;connection&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;id&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;is&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;13&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;Server&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;version&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;6&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;28&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ndb&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;7&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;cluster&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;gpl&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;MySQL&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;Cluster&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Community&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Server&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;GPL&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;Copyright&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;c&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2000&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2016&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Oracle&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;and&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;or&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;its&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;affiliates&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;All&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;rights&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;reserved&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;Oracle&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;is&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;a&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;registered&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;trademark&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;of&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Oracle&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Corporation&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;and&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;or&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;its&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;affiliates&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Other&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;names&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;may&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;be&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;trademarks&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;of&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;their&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;respective&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;owners&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;Type&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&#39;help;&#39;&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;or&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&#39;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\h&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&#39;&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;help&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;Type&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&#39;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\c&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&#39;&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;to&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;clear&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;the&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;current&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;input&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;statement&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;


&lt;span class=&quot;n&quot;&gt;mysql&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;CREATE&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;USER&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&#39;root&#39;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;@&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&#39;%&#39;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;IDENTIFIED&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;BY&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&#39;xxxxxxxx&#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;Query&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;OK&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;rows&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;affected&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;00&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sec&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;mysql&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; 
&lt;span class=&quot;n&quot;&gt;mysql&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;select&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;user&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;host&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;password&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;mysql&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;user&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;------+-----------+-------------------------------------------+
&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;user&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;host&lt;/span&gt;      &lt;span class=&quot;o&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;password&lt;/span&gt;                                  &lt;span class=&quot;o&quot;&gt;|&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;------+-----------+-------------------------------------------+
&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;root&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;localhost&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;3500&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;FB4BC9AEFE28B00C228XXXXXXXXXXXXXXXXX&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;|&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;root&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;127&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;3500&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;FB4BC9AEFE28B00C228XXXXXXXXXXXXXXXXX&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;|&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;root&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;       &lt;span class=&quot;o&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;3500&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;FB4BC9AEFE28B00C228XXXXXXXXXXXXXXXXX&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;|&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;root&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;%&lt;/span&gt;         &lt;span class=&quot;o&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;3500&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;FB4BC9AEFE28B00C228XXXXXXXXXXXXXXXXX&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;|&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;------+-----------+-------------------------------------------+
&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;4&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;rows&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;set&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;00&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sec&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;mysql&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;GRANT&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;ALL&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;PRIVILEGES&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;ON&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;TO&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&#39;root&#39;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;@&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&#39;%&#39;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;IDENTIFIED&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;BY&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;PASSWORD&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&#39;*3500FB4BC9AEFE28B00C228XXXXXXXXXXXXXXXXX&#39;&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;WITH&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;GRANT&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;OPTION&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;Query&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;OK&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;rows&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;affected&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;00&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sec&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;ul&gt;
  &lt;li&gt;On api 02 node, do same thing and then try to create a database on api01 and then you can see same database on api02.&lt;/li&gt;
&lt;/ul&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-sql&quot; data-lang=&quot;sql&quot;&gt;&lt;span class=&quot;o&quot;&gt;#&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;on&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;api01&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;mysql&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;show&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;databases&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;--------------------+
&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;Database&lt;/span&gt;           &lt;span class=&quot;o&quot;&gt;|&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;--------------------+
&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;information_schema&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;|&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;mysql&lt;/span&gt;              &lt;span class=&quot;o&quot;&gt;|&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ndbinfo&lt;/span&gt;            &lt;span class=&quot;o&quot;&gt;|&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;performance_schema&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;|&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;--------------------+
&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;4&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;rows&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;set&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;03&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sec&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;


&lt;span class=&quot;o&quot;&gt;#&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;on&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;api02&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;mysql&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;show&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;databases&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;--------------------+
&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;Database&lt;/span&gt;           &lt;span class=&quot;o&quot;&gt;|&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;--------------------+
&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;information_schema&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;|&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;mysql&lt;/span&gt;              &lt;span class=&quot;o&quot;&gt;|&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ndbinfo&lt;/span&gt;            &lt;span class=&quot;o&quot;&gt;|&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;performance_schema&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;|&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;--------------------+
&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;4&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;rows&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;set&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;02&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sec&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;


&lt;span class=&quot;o&quot;&gt;#&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;on&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;api01&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;again&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;mysql&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;create&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;database&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;TEST_DB_API01&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;Query&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;OK&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;row&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;affected&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;06&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sec&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;mysql&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;show&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;databases&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;--------------------+
&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;Database&lt;/span&gt;           &lt;span class=&quot;o&quot;&gt;|&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;--------------------+
&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;information_schema&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;|&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;TEST_DB_API01&lt;/span&gt;      &lt;span class=&quot;o&quot;&gt;|&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;mysql&lt;/span&gt;              &lt;span class=&quot;o&quot;&gt;|&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ndbinfo&lt;/span&gt;            &lt;span class=&quot;o&quot;&gt;|&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;performance_schema&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;|&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;--------------------+
&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;5&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;rows&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;set&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;00&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sec&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;


&lt;span class=&quot;o&quot;&gt;#&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;check&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;api02&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;node&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;mysql&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;show&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;databases&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;--------------------+
&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;Database&lt;/span&gt;           &lt;span class=&quot;o&quot;&gt;|&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;--------------------+
&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;information_schema&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;|&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;TEST_DB_API01&lt;/span&gt;      &lt;span class=&quot;o&quot;&gt;|&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;mysql&lt;/span&gt;              &lt;span class=&quot;o&quot;&gt;|&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ndbinfo&lt;/span&gt;            &lt;span class=&quot;o&quot;&gt;|&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;performance_schema&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;|&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;--------------------+
&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;5&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;rows&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;set&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;00&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sec&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;h3 id=&quot;reference&quot;&gt;Reference&lt;/h3&gt;

&lt;ul&gt;
  &lt;li&gt;
    &lt;p&gt;https://www.howtoforge.com/tutorial/how-to-install-and-configure-mysql-cluster-on-centos-7/&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;http://dev.mysql.com/doc/refman/5.7/en/mysql-cluster-installation.html&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;http://dev.mysql.com/doc/refman/5.7/en/mysql-cluster-management.html&lt;/p&gt;
  &lt;/li&gt;
&lt;/ul&gt;
</description>
        <pubDate>Wed, 01 Jun 2016 00:00:00 +0900</pubDate>
        <link>/2016/06/01/MySQL-Cluster-Set-up/</link>
        <guid isPermaLink="true">/2016/06/01/MySQL-Cluster-Set-up/</guid>
        
        
        <category>mySQL</category>
        
      </item>
    
      <item>
        <title>timezone change on CentOS</title>
        <description>&lt;ul&gt;
  &lt;li&gt;timezone change on CentOS&lt;/li&gt;
&lt;/ul&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;c&quot;&gt;## Change to UTC&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;root@test ~]# rm /etc/localtime
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;root@test ~]# ln -s /usr/share/zoneinfo/UTC /etc/localtime

 
&lt;span class=&quot;c&quot;&gt;## You can find other timezone on /usr/share/zoneinfo/&lt;/span&gt;


&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;root@test ~]# vi /etc/sysconfig/clock
&lt;span class=&quot;c&quot;&gt;## edit ZONE value&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;ZONE&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;Etc/UTC&quot;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;After change tomezone on server, you should restart all the daemons your server actively uses.&lt;/li&gt;
&lt;/ul&gt;
</description>
        <pubDate>Mon, 29 Sep 2014 00:00:00 +0900</pubDate>
        <link>/2014/09/29/timezone-change-on-CentOS/</link>
        <guid isPermaLink="true">/2014/09/29/timezone-change-on-CentOS/</guid>
        
        
        <category>linux</category>
        
      </item>
    
      <item>
        <title>mysqldump (db backup/ restore)</title>
        <description>&lt;h4 id=&quot;data-backup-using-mysqldump&quot;&gt;Data backup using mysqldump&lt;/h4&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;c&quot;&gt;## whole DB backup&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;root@test ~]# mysqldump -u USER_NAME -p DB_NAME &amp;gt; /tmp/DB_FILE_NAME.sql


&lt;span class=&quot;c&quot;&gt;## table dump&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;root@test ~]# mysqldump -u USER_NAME -p DB_NAME TABLE_NAME &amp;gt; /tmp/FILE_NAME.sql


&lt;span class=&quot;c&quot;&gt;## specific data dump - field:no , value: 5~10 (-w option)&lt;/span&gt;
 &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;root@test ~]# mysqldump -u USER_NAME -p DB_NAME TABLE_NAME -w  &lt;span class=&quot;s1&quot;&gt;&#39;no=&amp;gt;5 and no=&amp;lt;10&#39;&lt;/span&gt; &amp;gt; /tmp/FILE_NAME.sql


&lt;span class=&quot;c&quot;&gt;## to create an empty copy of the db/table (-d option)&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;root@test ~]# mysqldump -u USER_NAME -p -d DB_NAME &amp;gt; /tmp/FILE_NAME.sql
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;root@test ~]# mysqldump -u USER_NAME -p -d DB_NAME TABLE_NAME &amp;gt; /tmp/FILE_NAME.sql&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;h4 id=&quot;data-restore-using-mysqldump&quot;&gt;Data restore using mysqldump&lt;/h4&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;root@test ~]# mysql -u USER_NAME -p &amp;lt; /tmp/DB_FILE_NAME.sql
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;root@test ~]# mysql -u USER_NAME -p DB_NAME &amp;lt; /tmp/FILE_NAME.sql&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

</description>
        <pubDate>Mon, 29 Sep 2014 00:00:00 +0900</pubDate>
        <link>/2014/09/29/mySQLdump/</link>
        <guid isPermaLink="true">/2014/09/29/mySQLdump/</guid>
        
        
        <category>mySQL</category>
        
      </item>
    
      <item>
        <title>SSH login delay</title>
        <description>&lt;ul&gt;
  &lt;li&gt;How to fix once ssh login delay.&lt;/li&gt;
&lt;/ul&gt;

&lt;h5 id=&quot;disable-reverse-dns-lookups-in-ssh-config-for-all-linux&quot;&gt;1) Disable reverse dns lookups in ssh config. (for All linux)&lt;/h5&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;gp&quot;&gt;root@test:~# &lt;/span&gt;vi /etc/ssh/sshd_config


&lt;span class=&quot;c&quot;&gt;## add this line if it is not.&lt;/span&gt;
UseDNS no


&lt;span class=&quot;gp&quot;&gt;root@test:~# &lt;/span&gt;service ssh restart
ssh stop/waiting
ssh start/running, process 23813&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;h5 id=&quot;disable-gssapiauthentication-ubuntu&quot;&gt;2) Disable GSSAPIAuthentication (Ubuntu)&lt;/h5&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;gp&quot;&gt;root@test:~# &lt;/span&gt;vi /etc/ssh/sshd_config

 
&lt;span class=&quot;c&quot;&gt;## change to no from yes&lt;/span&gt;
    GSSAPIAuthentication no


&lt;span class=&quot;gp&quot;&gt;root@test:~# &lt;/span&gt;service ssh restart
ssh stop/waiting
ssh start/running, process 24193&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

</description>
        <pubDate>Wed, 24 Sep 2014 00:00:00 +0900</pubDate>
        <link>/2014/09/24/SSH-login-delay/</link>
        <guid isPermaLink="true">/2014/09/24/SSH-login-delay/</guid>
        
        
        <category>linux</category>
        
      </item>
    
      <item>
        <title>GIT server setup / clone on client</title>
        <description>&lt;h4 id=&quot;install-server&quot;&gt;Install (Server)&lt;/h4&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;root@test ~]# yum install git&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;h4 id=&quot;first-set-up-server&quot;&gt;first set up (Server)&lt;/h4&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;c&quot;&gt;## setup user name / email&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;root@test ~]# git config --global user.name &lt;span class=&quot;s2&quot;&gt;&quot;Ann Moon&quot;&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;root@test ~]# git config --global user.email annmoon@test.com


&lt;span class=&quot;c&quot;&gt;## If you want to use diff tool to resolve merge conflicts, &lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;root@test ~]# git config --global merge.tool vimdiff


&lt;span class=&quot;c&quot;&gt;## Checking Your Settings&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;root@test ~]# git config --list


&lt;span class=&quot;c&quot;&gt;## create init repository&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;root@test ~]# mkdir -p /var/git
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;root@test ~]# chmod -R 777 /var/git
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;root@test ~]# &lt;span class=&quot;nb&quot;&gt;cd&lt;/span&gt; /var/git
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;root@test git]# git init
Initialized empty Git repository &lt;span class=&quot;k&quot;&gt;in&lt;/span&gt; /var/git/.git/


&lt;span class=&quot;c&quot;&gt;## create test file and commit&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;root@test git]# touch index.html
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;root@test git]# git add index.html
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;root@test git]# git commit -m &lt;span class=&quot;s2&quot;&gt;&quot;first file&quot;&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;master &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;root-commit&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; 1e421b4] first file
 0 files changed, 0 insertions&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;+&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;, 0 deletions&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;-&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
 create mode 100644 index.html


&lt;span class=&quot;c&quot;&gt;## create bare repository&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;root@test git]# git clone --bare my_project my_project.git&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;h4 id=&quot;using-git-client&quot;&gt;using git (Client)&lt;/h4&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;c&quot;&gt;## on client (working pc)&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;root@annmoon ~]# git clone annmoon@server_ip or domain:/var/git/my_project.git


&lt;span class=&quot;c&quot;&gt;## note) if you commit and push at first time, you should use --set-upstream origin master on push command like, &lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;annmoon@annmoon my_project]&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;git push --set-upstream origin master&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;Reference:&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;a href=&quot;http://stackoverflow.com/questions/315911/git-for-beginners-the-definitive-practical-guide&quot;&gt;http://stackoverflow.com/questions/315911/git-for-beginners-the-definitive-practical-guide&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;http://git-scm.com/book/en/Getting-Started-Installing-Git&quot;&gt;http://git-scm.com/book/en/Getting-Started-Installing-Git&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;http://git-scm.com/book/en/Getting-Started-First-Time-Git-Setup&quot;&gt;http://git-scm.com/book/en/Getting-Started-First-Time-Git-Setup&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;http://rogerdudler.github.io/git-guide/index.ko.html&quot;&gt;http://rogerdudler.github.io/git-guide/index.ko.html&lt;/a&gt;&lt;/p&gt;

</description>
        <pubDate>Wed, 24 Sep 2014 00:00:00 +0900</pubDate>
        <link>/2014/09/24/Git-server-setup/</link>
        <guid isPermaLink="true">/2014/09/24/Git-server-setup/</guid>
        
        
        <category>linux</category>
        
      </item>
    
      <item>
        <title>How to create RPM package</title>
        <description>&lt;ul&gt;
  &lt;li&gt;This is to provide how to create RPM package. it is tested on centos 6.5&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;h4 id=&quot;create-rpm-build-env&quot;&gt;Create rpm build ENV&lt;/h4&gt;

&lt;h5 id=&quot;check-if-rpm-build-is-installed&quot;&gt;1) check if rpm-build is installed&lt;/h5&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;c&quot;&gt;## check if rpm-build is installed.&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;root@test1 ~]# rpm -qa rpm-build
rpm-build-4.8.0-37.el6.x86_64
&lt;span class=&quot;c&quot;&gt;## If not installed, install this package at first.&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;root@test1 ~]# yum install rpm-build&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h5 id=&quot;login-as-build-user--create-directory&quot;&gt;2) login as build user / create directory&lt;/h5&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;c&quot;&gt;## my build user is annmoon&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;root@test1 ~]# su - annmoon
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;annmoon@test1 ~]&lt;span class=&quot;err&quot;&gt;$&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;annmoon@test1 ~]&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;mkdir -p ~/rpmbuild/&lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;RPMS,SRPMS,BUILD,SOURCES,SPECS,tmp&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;annmoon@test1 ~]&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;cat &lt;span class=&quot;sh&quot;&gt;&amp;lt;&amp;lt;EOF &amp;gt;~/.rpmmacros
&amp;gt; %_topdir   %(echo $HOME)/rpmbuild
&amp;gt; %_tmppath  %{_topdir}/tmp
&amp;gt; EOF
[annmoon@test1 ~]$ 
[annmoon@test1 ~]$ cd ~/rpmbuild
&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;[annmoon@test1 rpmbuild]$ &lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;h4 id=&quot;create-source-file&quot;&gt;Create source file&lt;/h4&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;c&quot;&gt;## to test building package, please make simple shell script.&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;annmoon@test1 rpmbuild]&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;mkdir hello-test-1.0.0
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;annmoon@test1 rpmbuild]&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;cat &lt;span class=&quot;sh&quot;&gt;&amp;lt;&amp;lt;EOF &amp;gt; hello-test-1.0.0/hello-test
&amp;gt; #!/bin/bash
&amp;gt; echo hello!
&amp;gt; EOF
[annmoon@test1 rpmbuild]$ sh hello-test-1.0.0/hello-test
hello!
[annmoon@test1 rpmbuild]$ 
[annmoon@test1 rpmbuild]$ tar czvf hello-test-1.0.0.tar.gz hello-test-1.0.0/
hello-test-1.0.0/
&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;hello-test-1.0.0/hello-test&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;h4 id=&quot;create-spec-file&quot;&gt;Create SPEC file&lt;/h4&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;annmoon@test1 rpmbuild]&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;cp hello-test-1.0.0.tar.gz SOURCES/
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;annmoon@test1 rpmbuild]&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;vi SPECS/hello-test.spec


Name: hello-test
Version: 1.0.0


Release:        1%&lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;?dist&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
Summary: A hello &lt;span class=&quot;nb&quot;&gt;test &lt;/span&gt;package


Group:  Testing
License: GPL
URL: http://ann-moon.tistory.com
Source0: %&lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;name&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;-%&lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;version&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;.tar.gz
BuildRoot:      %&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;mktemp -ud %&lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;_tmppath&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;/%&lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;name&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;-%&lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;version&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;-%&lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;release&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;-XXXXXX&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;


%description
A hello &lt;span class=&quot;nb&quot;&gt;test &lt;/span&gt;package


%prep
%setup -q


%build


%install
rm -rf &lt;span class=&quot;nv&quot;&gt;$RPM_BUILD_ROOT&lt;/span&gt;
mkdir -p &lt;span class=&quot;nv&quot;&gt;$RPM_BUILD_ROOT&lt;/span&gt;/tmp/bin
cp hello-test &lt;span class=&quot;nv&quot;&gt;$RPM_BUILD_ROOT&lt;/span&gt;/tmp/bin


%clean
rm -rf &lt;span class=&quot;nv&quot;&gt;$RPM_BUILD_ROOT&lt;/span&gt;


%files
%defattr&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;-,root,root,-&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
%attr&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;0755,root,root&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;/tmp/bin/hello-test


%changelog
&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt; Mon Aug 11 2014 Ann Moon &amp;lt;annmoon@example.com&amp;gt; - 1.0.0
- Initial RPM&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;h4 id=&quot;build-package&quot;&gt;Build package&lt;/h4&gt;

&lt;ul&gt;
  &lt;li&gt;If you do not have GPG key, go to &lt;a href=&quot;/2014/08/11/Create-GPG-Key-for-building-package/&quot;&gt;HERE&lt;/a&gt; to create GPG key.&lt;/li&gt;
&lt;/ul&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;annmoon@test1 rpmbuild]&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;rpmbuild --sign -ba SPECS/hello-test.spec                                                                                                                                    
Enter pass phrase: 
Pass phrase is good.
Executing&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;%prep&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;: /bin/sh -e /home/annmoon/rpmbuild/tmp/rpm-tmp.U6255E
+ &lt;span class=&quot;nb&quot;&gt;umask &lt;/span&gt;022
+ &lt;span class=&quot;nb&quot;&gt;cd&lt;/span&gt; /home/annmoon/rpmbuild/BUILD
+ &lt;span class=&quot;nv&quot;&gt;LANG&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;C
+ &lt;span class=&quot;nb&quot;&gt;export &lt;/span&gt;LANG
+ &lt;span class=&quot;nb&quot;&gt;unset &lt;/span&gt;DISPLAY
+ &lt;span class=&quot;nb&quot;&gt;cd&lt;/span&gt; /home/annmoon/rpmbuild/BUILD
+ rm -rf hello-test-1.0.0
+ /usr/bin/gzip -dc /home/annmoon/rpmbuild/SOURCES/hello-test-1.0.0.tar.gz
+ /bin/tar -xf -
+ &lt;span class=&quot;nv&quot;&gt;STATUS&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;0
+ &lt;span class=&quot;s1&quot;&gt;&#39;[&#39;&lt;/span&gt; 0 -ne 0 &lt;span class=&quot;s1&quot;&gt;&#39;]&#39;&lt;/span&gt;
+ &lt;span class=&quot;nb&quot;&gt;cd &lt;/span&gt;hello-test-1.0.0
+ /bin/chmod -Rf a+rX,u+w,g-w,o-w .
+ &lt;span class=&quot;nb&quot;&gt;exit &lt;/span&gt;0
Executing&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;%build&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;: /bin/sh -e /home/annmoon/rpmbuild/tmp/rpm-tmp.jKR5Uh
+ &lt;span class=&quot;nb&quot;&gt;umask &lt;/span&gt;022
+ &lt;span class=&quot;nb&quot;&gt;cd&lt;/span&gt; /home/annmoon/rpmbuild/BUILD
+ &lt;span class=&quot;nb&quot;&gt;cd &lt;/span&gt;hello-test-1.0.0
 
~~~~~~~~ &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;SKIP&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;


Processing files: hello-test-1.0.0-1.el6.x86_64
Requires&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;rpmlib&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;: rpmlib&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;CompressedFileNames&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &amp;lt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; 3.0.4-1 rpmlib&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;FileDigests&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &amp;lt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; 4.6.0-1 rpmlib&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;PayloadFilesHavePrefix&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &amp;lt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; 4.0-1
Processing files: hello-test-debuginfo-1.0.0-1.el6.x86_64
Checking &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;unpackaged file&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;s&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;: /usr/lib/rpm/check-files /home/annmoon/rpmbuild/BUILDROOT/hello-test-1.0.0-1.el6.x86_64
Generating signature: 1005
Wrote: /home/annmoon/rpmbuild/SRPMS/hello-test-1.0.0-1.el6.src.rpm
Generating signature: 1005
Wrote: /home/annmoon/rpmbuild/RPMS/x86_64/hello-test-1.0.0-1.el6.x86_64.rpm
Generating signature: 1005
Wrote: /home/annmoon/rpmbuild/RPMS/x86_64/hello-test-debuginfo-1.0.0-1.el6.x86_64.rpm
Executing&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;%clean&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;: /bin/sh -e /home/annmoon/rpmbuild/tmp/rpm-tmp.BjJwQC
+ &lt;span class=&quot;nb&quot;&gt;umask &lt;/span&gt;022
+ &lt;span class=&quot;nb&quot;&gt;cd&lt;/span&gt; /home/annmoon/rpmbuild/BUILD
+ &lt;span class=&quot;nb&quot;&gt;cd &lt;/span&gt;hello-test-1.0.0
+ rm -rf /home/annmoon/rpmbuild/BUILDROOT/hello-test-1.0.0-1.el6.x86_64
+ &lt;span class=&quot;nb&quot;&gt;exit &lt;/span&gt;0


&lt;span class=&quot;c&quot;&gt;## check the RPM&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;annmoon@test1 rpmbuild]&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;ls -al RPMS/x86_64/
total 16
drwxr-xr-x. 2 annmoon annmoon 4096 Aug 11 06:19 .
drwxrwxr-x. 3 annmoon annmoon 4096 Aug 11 06:19 ..
-rw-rw-r--. 1 annmoon annmoon 2276 Aug 11 06:19 hello-test-1.0.0-1.el6.x86_64.rpm&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

</description>
        <pubDate>Mon, 11 Aug 2014 00:00:00 +0900</pubDate>
        <link>/2014/08/11/How-to-create-RPM-package/</link>
        <guid isPermaLink="true">/2014/08/11/How-to-create-RPM-package/</guid>
        
        
        <category>linux</category>
        
      </item>
    
      <item>
        <title>Create yum repository</title>
        <description>&lt;ul&gt;
  &lt;li&gt;This is to provide how to create YUM repository. it is tested on CentOS 6.5&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;h4 id=&quot;preparation&quot;&gt;Preparation&lt;/h4&gt;

&lt;h5 id=&quot;create-rpm-gpg-key&quot;&gt;1) Create RPM GPG Key&lt;/h5&gt;

&lt;ul&gt;
  &lt;li&gt;If you do not have GPG key, go to &lt;a href=&quot;/2014/08/11/Create-GPG-Key-for-building-package/&quot;&gt;HERE&lt;/a&gt; to create GPG key.&lt;/li&gt;
&lt;/ul&gt;

&lt;h5 id=&quot;install-createrepo&quot;&gt;2) Install createrepo&lt;/h5&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;c&quot;&gt;## check if package is installed.&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;root@test1 ~]# rpm -qa createrepo
createrepo-0.9.9-18.el6.noarch


 &lt;span class=&quot;c&quot;&gt;## if not installed, install createrepo&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;root@test1 ~]# yum install createrepo&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;h5 id=&quot;install-apache&quot;&gt;3) Install apache&lt;/h5&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;c&quot;&gt;## check if package is installed.&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;root@test1 ~]# rpm -qa httpd
httpd-2.2.15-29.el6.centos.x86_64


&lt;span class=&quot;c&quot;&gt;## if not installed, install httpd&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;root@test1 ~]# yum install httpd


&lt;span class=&quot;c&quot;&gt;## apache start&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;root@test1 ~]# service httpd start


&lt;span class=&quot;c&quot;&gt;## for detail configuration of apache, please see this - http://httpd.apache.org/docs/2.2/configuring.html&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;h4 id=&quot;create-repository-directory&quot;&gt;Create repository directory.&lt;/h4&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;root@test1  ~]# mkdir -p /var/www/html/repo/Packages
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;root@test1 ~]# cp /home/annmoon/rpmbuild/RPMS/x86_64/hello-test-1.0.0-1.el6.x86_64.rpm /var/www/html/repo/Packages/
&lt;span class=&quot;c&quot;&gt;## annmoon is rpm build user which is created on http://ann-moon.tistory.com/109&lt;/span&gt;


&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;root@test ~]# createrepo -v /var/www/html/repo/
Spawning worker 0 with 1 pkgs
Worker 0: reading Packages/hello-test-1.0.0-1.el6.x86_64.rpm
Workers Finished
Gathering worker results


Saving Primary metadata
Saving file lists metadata
Saving other metadata
Generating sqlite DBs
Starting other db creation: Thu Sep 11 08:27:33 2014
Ending other db creation: Thu Sep 11 08:27:33 2014
Starting filelists db creation: Thu Sep 11 08:27:33 2014
Ending filelists db creation: Thu Sep 11 08:27:33 2014
Starting primary db creation: Thu Sep 11 08:27:33 2014
Ending primary db creation: Thu Sep 11 08:27:34 2014
Sqlite DBs &lt;span class=&quot;nb&quot;&gt;complete&lt;/span&gt;


&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;root@test1 ~]# cp /home/annmoon/rpmbuild/RPM-GPG-KEY-builduser /var/www/html/repo/


&lt;span class=&quot;c&quot;&gt;## check RPM-GPG-KEY-builduser via web &lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;## (my http port is 8080. If you just set up by 80, use curl http://127.0.0.1/repo/RPM-GPG-KEY-builduser)&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;root@KRBONSTEST1 ~]# curl http://127.0.0.1:8080/repo/RPM-GPG-KEY-builduser
-----BEGIN PGP PUBLIC KEY BLOCK-----
Version: GnuPG v2.0.14 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;GNU/Linux&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
~~~~ SKIP
-----END PGP PUBLIC KEY BLOCK-----&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;h4 id=&quot;verify-repository&quot;&gt;Verify repository&lt;/h4&gt;

&lt;h5 id=&quot;connection-test-from-other-computer&quot;&gt;1) connection test from other computer.&lt;/h5&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;c&quot;&gt;## from test2&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;root@test2 ~]# nc -z test1.test.com 8080
Connection to test1.test.com 8080 port &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;tcp/webcache] succeeded!


&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;root@test2 ~]# curl http://test1.test.com:8080/repo/RPM-GPG-KEY-builduser
-----BEGIN PGP PUBLIC KEY BLOCK-----
Version: GnuPG v2.0.14 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;GNU/Linux&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
~~~ SKIP
-----END PGP PUBLIC KEY BLOCK-----&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;h5 id=&quot;add-repository&quot;&gt;2) add repository&lt;/h5&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;c&quot;&gt;## from test2&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;root@test2 ~]# &lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;[test1-repo]
&amp;gt; name=Test1 Repo
&amp;gt; baseurl=http://test1.test.com:8080/repo
&amp;gt; gpgkey=http://test1.test.com:8080/repo/RPM-GPG-KEY-builduser
&amp;gt; enabled=1
&amp;gt; gpgcheck=1&quot;&lt;/span&gt; &amp;gt; /etc/yum.repos.d/test1-repo.repo


&lt;span class=&quot;c&quot;&gt;## check if test1-repo&#39;s status. it will have 1 pkg.&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;root@test2 yum.repos.d]# yum repolist&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;h4 id=&quot;install-test-package&quot;&gt;3) install test package&lt;/h4&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;root@test2 ~]# yum install hello-test
Loaded plugins: fastestmirror
Loading mirror speeds from cached hostfile
 &lt;span class=&quot;k&quot;&gt;*&lt;/span&gt; base: ftp.riken.jp
 &lt;span class=&quot;k&quot;&gt;*&lt;/span&gt; extras: ftp.riken.jp
 &lt;span class=&quot;k&quot;&gt;*&lt;/span&gt; updates: ftp.nara.wide.ad.jp
Setting up Install Process
Resolving Dependencies
&lt;span class=&quot;gp&quot;&gt;--&amp;gt; &lt;/span&gt;Running transaction check
&lt;span class=&quot;gp&quot;&gt;---&amp;gt; &lt;/span&gt;Package hello-test.x86_64 0:1.0.0-1.el6 will be installed
&lt;span class=&quot;gp&quot;&gt;--&amp;gt; &lt;/span&gt;Finished Dependency Resolution


Dependencies Resolved


&lt;span class=&quot;o&quot;&gt;==================================================================================================================================================================================================&lt;/span&gt;
 Package                                         Arch                                        Version                                             Repository                                             Size
&lt;span class=&quot;o&quot;&gt;==================================================================================================================================================================================================&lt;/span&gt;
Installing:
 hello-test                                      x86_64                                      1.0.0-1.el6                                         krbonstest1-repo                                      2.8 k


Transaction Summary
&lt;span class=&quot;o&quot;&gt;==================================================================================================================================================================================================&lt;/span&gt;
Install       1 Package&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;s&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

</description>
        <pubDate>Mon, 11 Aug 2014 00:00:00 +0900</pubDate>
        <link>/2014/08/11/Create-yum-repository/</link>
        <guid isPermaLink="true">/2014/08/11/Create-yum-repository/</guid>
        
        
        <category>linux</category>
        
      </item>
    
      <item>
        <title>Create GPG Key for building package</title>
        <description>&lt;p&gt;This is to provide how to generate GPG key for RPM build.&lt;/p&gt;

&lt;h4 id=&quot;build-user-create&quot;&gt;build user create&lt;/h4&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;root@test1 ~]# adduser annmoon
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;root@test1 ~]# su - annmoon
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;annmoon@test1 ~]&lt;span class=&quot;err&quot;&gt;$&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h4 id=&quot;start-gpg-agent&quot;&gt;start gpg-agent&lt;/h4&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;annmoon@test1 ~]&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;rngd -r /dev/urandom
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;annmoon@test1 ~]&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;gpg-agent --use-standard-socket --daemon
gpg-agent[11340]: directory &lt;span class=&quot;sb&quot;&gt;`&lt;/span&gt;/home/annmoon/.gnupg&lt;span class=&quot;s1&quot;&gt;&#39; created
gpg-agent[11340]: directory `/home/annmoon/.gnupg/private-keys-v1.d&#39;&lt;/span&gt; created
&lt;span class=&quot;nv&quot;&gt;GPG_AGENT_INFO&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;/root/.gnupg/S.gpg-agent:11341:1; &lt;span class=&quot;nb&quot;&gt;export &lt;/span&gt;GPG_AGENT_INFO;
gpg-agent[11341]: gpg-agent &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;GnuPG&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; 2.0.14 started&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h4 id=&quot;key-create&quot;&gt;Key create&lt;/h4&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;annmoon@test1 ~]&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;cat &lt;span class=&quot;sh&quot;&gt;&amp;lt;&amp;lt;EOF | gpg --batch --no-tty --gen-key
&amp;gt; %echo Generating a standard key
&amp;gt; Key-Type: default
&amp;gt; Key-Length: 2048
&amp;gt; Subkey-Type: default
&amp;gt; Subkey-Length: 2048
&amp;gt; Name-Real: Ann Moon
&amp;gt; Name-Email: annmoon@example.com
&amp;gt; Expire-Date: 5y
&amp;gt; Passphrase: 사용할 패스워드
&amp;gt; %commit
&amp;gt; %echo done
&amp;gt; EOF
gpg: keyring `/home/annmoon/.gnupg/secring.gpg&#39; created
gpg: keyring `/home/annmoon/.gnupg/pubring.gpg&#39; created
gpg: Generating a standard key
gpg: /home/annmoon/.gnupg/trustdb.gpg: trustdb created
gpg: key 34ECC635 marked as ultimately trusted
&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;gpg: done&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h4 id=&quot;check-gpg-fingerprint&quot;&gt;check gpg fingerprint&lt;/h4&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;annmoon@test1 ~]&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;gpg --fingerprint
gpg: checking the trustdb
gpg: 3 marginal&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;s&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; needed, 1 &lt;span class=&quot;nb&quot;&gt;complete&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;s&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; needed, PGP trust model
gpg: depth: 0  valid:   1  signed:   0  trust: 0-, 0q, 0n, 0m, 0f, 1u
gpg: next trustdb check due at 2019-07-30
/home/annmoon/.gnupg/pubring.gpg
------------------------
pub   2048R/34ECC635 2014-08-07 &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;expires: 2019-07-30]
      Key fingerprint &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; DABF 4D10 6691 1A4D 3A33  E5BE 83C5 9C90 34EC C635
uid                  Ann Moon &amp;lt;annmoon@example.com&amp;gt;
sub   2048R/F8AB3611 2014-08-07 &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;expires: 2019-07-30]&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h4 id=&quot;export-key-file&quot;&gt;export key file&lt;/h4&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;annmoon@test1 ~]&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;gpg -a -o RPM-GPG-KEY-builduser --export 34ECC635
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;annmoon@test1 ~]&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;cat RPM-GPG-KEY-builduser
-----BEGIN PGP PUBLIC KEY BLOCK-----
Version: GnuPG v2.0.14 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;GNU/Linux&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; 
mQENBFPjJvgBCACyUcuJUGaaBiUG70lf/mKHORj4d0sInhjaDjfvtWRA59b+opPI
DnzeFL3Mkdgg72yUsavNv3sAwC9RiHstCIlIL5Nq4VXF3sP9Lui8IYXhVC3DFnh/
~~~~ SKIP
-----END PGP PUBLIC KEY BLOCK-----&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h4 id=&quot;if-you-want-to-use-this-key-to-build-rpm-you-need-to-put-this-line-into-rpmmacros&quot;&gt;If you want to use this key to build RPM, you need to put this line into .rpmmacros&lt;/h4&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;annmoon@test1 ~]&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&#39;%_gpg_name 34ECC635&#39;&lt;/span&gt; &amp;gt;&amp;gt; ~/.rpmmacros
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;annmoon@test1 ~]&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;cat ~/.rpmmacros
%_gpg_name 34ECC635&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

</description>
        <pubDate>Mon, 11 Aug 2014 00:00:00 +0900</pubDate>
        <link>/2014/08/11/Create-GPG-Key-for-building-package/</link>
        <guid isPermaLink="true">/2014/08/11/Create-GPG-Key-for-building-package/</guid>
        
        <category>Create GPG Key for building package</category>
        
        
        <category>linux</category>
        
      </item>
    
      <item>
        <title>Two Factor SSH with Google Authenticator</title>
        <description>&lt;ul&gt;
  &lt;li&gt;How to set up Two Factor SSH with Google Authenticator (on CentOS 6)&lt;/li&gt;
&lt;/ul&gt;

&lt;h4 id=&quot;download--install&quot;&gt;Download &amp;amp; Install&lt;/h4&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;root@test ~]# yum install make gcc pam-devel
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;root@test ~]# yum install wget
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;root@test ~]# yum install ntp
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;root@test ~]# /etc/init.d/ntpd start
Starting ntpd:                                             &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;  OK  &lt;span class=&quot;o&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;root@test ~]# chkconfig ntpd on
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;root@test ~]# &lt;span class=&quot;nb&quot;&gt;cd&lt;/span&gt; /opt/
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;root@test opt]# wget https://google-authenticator.googlecode.com/files/libpam-google-authenticator-1.0-source.tar.bz2
--2014-09-11 15:11:58--  https://google-authenticator.googlecode.com/files/libpam-google-authenticator-1.0-source.tar.bz2
Resolving google-authenticator.googlecode.com... 173.194.72.82, 2404:6800:4008:c04::52
Connecting to google-authenticator.googlecode.com|173.194.72.82|:443... connected.
ERROR: cannot verify google-authenticator.googlecode.com’s certificate, issued by “/C&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;KR/ST&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;Seoul/L&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;Seoul/~~~~~~~”:
  Unable to locally verify the issuer’s authority.
To connect to google-authenticator.googlecode.com insecurely, use ‘--no-check-certificate’.

&lt;span class=&quot;c&quot;&gt;## if you see above error, you need to use --no-check-certificate option &lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;root@test opt]# wget --no-check-certificate https://google-authenticator.googlecode.com/files/libpam-google-authenticator-1.0-source.tar.bz2

&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;root@test opt]# bzip2 -d libpam-google-authenticator-1.0-source.tar.bz2
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;root@test opt]# tar -xvf libpam-google-authenticator-1.0-source.tar
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;root@test opt]# &lt;span class=&quot;nb&quot;&gt;cd &lt;/span&gt;libpam-google-authenticator-1.0
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;root@test libpam-google-authenticator-1.0]# 
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;root@test libpam-google-authenticator-1.0]# make
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;root@test libpam-google-authenticator-1.0]# make install&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;h4 id=&quot;set-up-google-authenticator&quot;&gt;Set up Google Authenticator&lt;/h4&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;- Run “google-authenticator” as the user you want to log &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;with via SSH
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;root@test libpam-google-authenticator-1.0]# su - ann
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;ann@test ~]&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;google-authenticator
Do you want authentication tokens to be &lt;span class=&quot;nb&quot;&gt;time&lt;/span&gt;-based &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;y/n&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; y
https://www.google.com/chart?chs&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;200x200&amp;amp;chld&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;M|0&amp;amp;cht&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;qr&amp;amp;chl&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;otpauth://totp/ann@krbonstool01%3Fsecret%3DEFZSVUJOIT3373OR
Your new secret key is: EFZSVUJOIT3373OR
Your verification code is 343638
Your emergency scratch codes are:
  12537915
  43625506
  55016125
  81323386
  33075629
Do you want me to update your &lt;span class=&quot;s2&quot;&gt;&quot;/home/ann/.google_authenticator&quot;&lt;/span&gt; file &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;y/n&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; y
Do you want to disallow multiple uses of the same authentication
token? This restricts you to one login about every 30s, but it increases
your chances to notice or even prevent man-in-the-middle attacks &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;y/n&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; y
By default, tokens are good &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;30 seconds and &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;order to compensate &lt;span class=&quot;k&quot;&gt;for
&lt;/span&gt;possible &lt;span class=&quot;nb&quot;&gt;time&lt;/span&gt;-skew between the client and the server, we allow an extra
token before and after the current time. If you experience problems with poor
&lt;span class=&quot;nb&quot;&gt;time &lt;/span&gt;synchronization, you can increase the window from its default
size of 1:30min to about 4min. Do you want to &lt;span class=&quot;k&quot;&gt;do &lt;/span&gt;so &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;y/n&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; y
If the computer that you are logging into is not hardened against brute-force
login attempts, you can &lt;span class=&quot;nb&quot;&gt;enable &lt;/span&gt;rate-limiting &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;the authentication module.
By default, this limits attackers to no more than 3 login attempts every 30s.
Do you want to &lt;span class=&quot;nb&quot;&gt;enable &lt;/span&gt;rate-limiting &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;y/n&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; y

- Open the URL and &lt;span class=&quot;k&quot;&gt;then &lt;/span&gt;scan the QR code using the Google Authenticator application on your smartphone.&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;h4 id=&quot;configuration&quot;&gt;Configuration&lt;/h4&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;- Enable Google authenticator &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;SSH login
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;ann@test ~]&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;exit
logout&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;root@test ~]# 
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;root@test ~]# vi /etc/pam.d/sshd
&lt;span class=&quot;c&quot;&gt;## add below line on the top.&lt;/span&gt;
auth       required     pam_google_authenticator.so


- Open the SSH configuration file and &lt;span class=&quot;nb&quot;&gt;set &lt;/span&gt;to yes &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; ‘ChallengeResponseAuthentication‘ line
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;root@test ~]# vi /etc/ssh/sshd_config
ChallengeResponseAuthentication yes


&lt;span class=&quot;c&quot;&gt;## restart sshd&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;root@test ~]# service sshd restart
Stopping sshd:                                             &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;  OK  &lt;span class=&quot;o&quot;&gt;]&lt;/span&gt;
Starting sshd:                                             &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;  OK  &lt;span class=&quot;o&quot;&gt;]&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h4 id=&quot;note&quot;&gt;NOTE&lt;/h4&gt;

&lt;ul&gt;
  &lt;li&gt;
    &lt;p&gt;If you cannot login with Verification code, you need to check SELINUX setting.&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;If SELINUX is set as enforcing, it should be changed to permissive or disabled&lt;/p&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;root@test ~]# vi /etc/selinux/config
&lt;span class=&quot;nv&quot;&gt;SELINUX&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;permissive&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

</description>
        <pubDate>Mon, 10 Feb 2014 00:00:00 +0900</pubDate>
        <link>/2014/02/10/Two-Factor-SSH-with-Google-Authenticator/</link>
        <guid isPermaLink="true">/2014/02/10/Two-Factor-SSH-with-Google-Authenticator/</guid>
        
        <category>Two Factor SSH</category>
        
        
        <category>linux</category>
        
      </item>
    
      <item>
        <title>CentOS Iptables</title>
        <description>&lt;ul&gt;
  &lt;li&gt;in case open 8080 port.&lt;/li&gt;
&lt;/ul&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;root@ServerA ~]# vi /etc/sysconfig/iptables

&lt;span class=&quot;c&quot;&gt;# add below line&lt;/span&gt;
-A INPUT -m state --state NEW -m tcp -p tcp --dport 8080 -j ACCEPT


&lt;span class=&quot;c&quot;&gt;# restart iptable&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;root@ServerA ~]# /sbin/iptables -L -v -n&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

</description>
        <pubDate>Fri, 06 Dec 2013 00:00:00 +0900</pubDate>
        <link>/2013/12/06/centos6-iptables/</link>
        <guid isPermaLink="true">/2013/12/06/centos6-iptables/</guid>
        
        <category>network</category>
        
        
        <category>linux</category>
        
      </item>
    
  </channel>
</rss>
